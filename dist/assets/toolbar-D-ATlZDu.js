import{_ as k,i as M,Q as S,R as P,r as i,v as j,e as C,f as u,o as d,c as f,a as l,w as b,b as E,n as I,g as O,S as x,j as B}from"./index-CcguAPKR.js";const L={style:{"border-radius":"0%",width:"100%","margin-bottom":"0.5em"}},N={key:0,id:"profile_button",class:"flex items-center gap-2"},F={__name:"toolbar",setup(z){const c=M("base_url"),m=S(),g=P(),t=i([{label:"Home",icon:"pi pi-home",command:()=>o("Home")},{label:"Marketplace",icon:"pi pi-shopping-bag",items:[{label:"Leroy",items:[{label:"Ofertas",icon:"pi pi-megaphone",command:()=>o("OfertasLeroy")},{label:"Trackings",icon:"pi pi-bolt",command:()=>o("TrackingsLeroy")},{label:"Encomendas",icon:"pi pi-shopping-bag"}],command:()=>o("Leroy")},{label:"Worten",command:()=>o("Worten")}]},{label:"Mensagens",icon:"pi pi-envelope"}]),_=i([{label:"Meu Perfil",icon:"pi pi-user",command:()=>o("Profile")},{separator:!0},{label:"Sair",icon:"pi pi-sign-out",command:y}]),p=i(null);function o(e){m.push({name:e})}function h(e){p.value.toggle(e)}async function y(){try{const e=await fetch(`${c}/member/logout`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});e.ok?m.push({name:"Login"}):console.error("Erro ao realizar logout",await e.json())}catch(e){console.error("Erro de rede ao tentar logout",e)}}async function v(){const e=JSON.parse(localStorage.getItem("profile")),s=localStorage.getItem("profileTimestamp"),n=new Date().getTime();if(!e||!s||n-s>6e4)try{const a=await fetch(`${c}/member/profile`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(a.ok){const r=await a.json();localStorage.setItem("profile",JSON.stringify(r)),localStorage.setItem("profileTimestamp",n.toString()),r.success&&r.data.funcao==="administrador"&&(t.value.push({label:"Faturas",icon:"pi pi-wallet",command:()=>o("Faturas")}),t.value.push({label:"Membros",icon:"pi pi-users",command:()=>o("Membros")}))}else console.error("Erro ao obter perfil",await a.json())}catch(a){console.error("Erro de rede ao tentar obter perfil",a)}else{const a=e;a.success&&a.data.funcao==="administrador"&&(t.value.push({label:"Faturas",icon:"pi pi-wallet",command:()=>o("Faturas")}),t.value.push({label:"Membros",icon:"pi pi-users",command:()=>o("Membros")}))}}const w=j(()=>g.name==="Profile");return C(()=>{v()}),(e,s)=>{const n=u("Button"),a=u("Menubar");return d(),f("div",L,[l(a,{model:t.value},{itemicon:b(({item:r,class:T})=>[E("i",{class:I(["pi",r.icon,T]),style:{"font-size":"smaller"}},null,2)]),end:b(()=>[w.value?B("",!0):(d(),f("div",N,[l(n,{label:"Perfil",icon:"pi pi-user",severity:"contrast",rounded:"",onClick:h}),l(O(x),{model:_.value,popup:!0,ref_key:"menu",ref:p},null,8,["model"])]))]),_:1},8,["model"])])}}},V=k(F,[["__scopeId","data-v-b96233f8"]]);export{V as t};

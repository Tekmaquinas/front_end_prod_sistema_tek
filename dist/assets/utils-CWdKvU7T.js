import{r as E,i as D,f as v,o as I,l as k,w as d,a as t,b as s,_ as C,d as j,q as P,e as N,c as A,t as _,m as S,v as O}from"./index-CcguAPKR.js";/* empty css                                                                     */const h={class:"flex items-center",style:{"justify-content":"space-between !important","margin-top":"20px"}},R={class:"flex items-center gap-4"},$={class:"flex items-center gap-4"},ae={__name:"PrepareOrders",props:{data:{type:Array,required:!0},route:{type:[String,Object],required:!0}},setup(a,{emit:c}){const l=E(!1),o=D("base_url"),e=a,n=c,i=E("Atribuir ao Automatizado"),b=E([{name:"Atribuir ao Ruben",code:2},{name:"Atribuir ao Automatizador",code:1}]),g=()=>{n("update:visible",!1),n("updateData",!1)},T=async()=>{const m={itens:e.data.map(u=>u.order_id),assigment:i.value.code};try{const u=await fetch(`${o}/orders/assignment?marketplace=${e.route}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(m),credentials:"include"});if(!u.ok)throw new Error(`Erro ${u.status}: Não foi possível atualizar.`);const r=await u.json();console.log("Resposta do servidor:",r),g(),n("updateData",r)}catch(u){console.error("Erro ao enviar alterações:",u)}};return(y,m)=>{const u=v("Column"),r=v("DataTable"),f=v("Select"),p=v("Button"),w=v("Dialog");return I(),k(w,{visible:l.value,"onUpdate:visible":m[1]||(m[1]=x=>l.value=x),modal:"",header:"Editar Porcentagem",style:{width:"50vw"},breakpoints:{"500px":"60vw","375px":"40vw"},maximizable:"",contentStyle:{height:"auto"}},{default:d(()=>[t(r,{value:a.data,showGridlines:"",style:{width:"100%"},size:"small"},{default:d(()=>[t(u,{field:"order_id",header:"Order ID"}),t(u,{field:"quantity",header:"Quantity"}),t(u,{field:"price",header:"Price"}),t(u,{field:"stock",header:"Stock"})]),_:1},8,["value"]),s("div",h,[s("div",R,[t(f,{modelValue:i.value,"onUpdate:modelValue":m[0]||(m[0]=x=>i.value=x),value:i.value,options:b.value,optionLabel:"name",placeholder:"Selecione Atribuição",invalid:!i.value,class:"w-full md:w-12"},null,8,["modelValue","value","options","invalid"])]),s("div",$,[t(p,{label:"Cancel",text:"",severity:"secondary",onClick:g,autofocus:""}),t(p,{label:"Save",severity:"contrast",onClick:T,autofocus:""})])])]),_:1},8,["visible"])}}},U={class:"flex justify-between",style:{padding:"0rem 1.5rem 1.5rem",display:"flex","flex-wrap":"wrap",width:"100%",gap:"15px"}},L={class:"count_orders"},M={class:"flex flex-wrap",style:{width:"100%",gap:"3.5px"}},H={class:"novos_registrados"},z={class:"count_orders"},F={class:"flex flex-wrap",style:{width:"100%",gap:"3.5px"}},q={class:"encomenda_registrados"},G={class:"count_orders"},V={class:"flex flex-wrap",style:{width:"100%",gap:"3.5px"}},B={class:"novos_registrados"},K={class:"count_orders"},J={class:"flex flex-wrap",style:{width:"100%","align-self":"baseline"}},Y={class:"trackings_pendentes"},Q={__name:"InfoOrders",props:{route:{type:[String,Object],required:!0}},setup(a){const c=D("base_url"),l=a,o=E({aguardando_envio:0,sem_link:0,prontos_para_encomendar:0}),e=E(!1),n=j();let i=null,b=!1;const g=(u,r)=>{const f=`${u}`,p={data:r,timestamp:Date.now()};sessionStorage.setItem(f,JSON.stringify(p))},T=(u,r)=>{const f=sessionStorage.getItem(`${u}`);if(!f)return null;const{data:p,timestamp:w}=JSON.parse(f);return Date.now()-w>r?null:p},y=async()=>{if(b)return;b=!0;const u=`orderStatistics_${l.route}`,r=1e4;e.value=!0;try{const f=T(u,r);if(f){o.value=f,e.value=!1,b=!1;return}const p=await fetch(`${c}/orders/statistics?marketplace=${l.route}`,{method:"GET",credentials:"include"});if(p.status===401){window.location.href="/login";return}if(!p.ok)throw new Error("Erro ao buscar as estatísticas");const w=await p.json();o.value=w,g(u,w)}catch(f){n.add({severity:"error",summary:"Erro ao Carregar Estatísticas",detail:f.message,group:"br",life:3e3})}finally{e.value=!1,b=!1}},m=()=>{i||(i=setInterval(()=>{y()},1e4))};return P(()=>{i&&(clearInterval(i),i=null)}),N(()=>{y(),m()}),(u,r)=>{const f=v("Card");return I(),A("div",U,[t(f,{style:{flex:"1","min-width":"200px"},class:"shadow"},{content:d(()=>[r[1]||(r[1]=s("div",{class:"flex justify-between",style:{width:"100%"}},[s("p",{class:"title_card"},"Pedidos Abertos"),s("i",{class:"pi pi-shopping-cart"})],-1)),s("div",null,[s("p",L,_(o.value.aguardando_envio),1)]),s("div",M,[s("p",null,[s("span",H,"+"+_(o.value.novos_adicionados)+" Novos",1),r[0]||(r[0]=S(" pedidos feitos"))])])]),_:1}),t(f,{style:{flex:"1","min-width":"200px"},class:"shadow"},{content:d(()=>[r[3]||(r[3]=s("div",{class:"flex justify-between",style:{width:"100%"}},[s("p",{class:"title_card"},"Encomendados"),s("i",{class:"pi pi-shopping-bag"})],-1)),s("div",null,[s("p",z,_(o.value.prontos_para_encomendar),1)]),s("div",F,[s("p",null,[s("span",q,_(o.value.pct_encomendados)+"%",1),r[2]||(r[2]=S(" encomendado"))])])]),_:1}),t(f,{style:{flex:"1","min-width":"200px"},class:"shadow"},{content:d(()=>[r[5]||(r[5]=s("div",{class:"flex justify-between",style:{width:"100%"}},[s("p",{class:"title_card"},"Trackings"),s("i",{class:"pi pi-bolt"})],-1)),s("div",null,[s("p",G,_(o.value.trackings_total),1)]),s("div",V,[s("p",null,[s("span",B,_(o.value.novos_trackings)+" Trackings",1),r[4]||(r[4]=S(" atualizados"))])])]),_:1}),t(f,{style:{flex:"1","min-width":"200px"},class:"shadow"},{content:d(()=>[r[7]||(r[7]=s("div",{class:"flex justify-between",style:{width:"100%"}},[s("p",{class:"title_card"},"Produtos sem Link"),s("i",{class:"pi pi-link"})],-1)),s("div",null,[s("p",K,_(o.value.sem_link),1)]),s("div",J,[s("p",null,[s("span",Y,_(o.value.novos_sem_link)+"% ",1),r[6]||(r[6]=S("precisa de links"))])])]),_:1})])}}},le=C(Q,[["__scopeId","data-v-6f26291b"]]),Z={class:"card",style:{width:"100%"}},W={class:"grid-container",style:{width:"100%"}},X={class:"grid grid-cols-4",style:{"flex-wrap":"wrap","column-gap":"5px"}},ee={__name:"RowExpansion",props:{data:{type:Object,required:!0}},setup(a){const c=a;O(()=>{var o;return(o=c.data)!=null&&o.created_date?new Date(c.data.created_date).toLocaleString():"N/A"});const l=o=>o!=null&&o!==""?o:"...";return(o,e)=>{const n=v("InputText"),i=v("IftaLabel"),b=v("Fieldset");return I(),A("div",Z,[s("div",W,[t(b,{legend:"Detalhes do Pedido",class:"fieldset"},{default:d(()=>[s("div",X,[t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",value:l(`${a.data.firstname} ${a.data.lastname}`),disabled:""},null,8,["value"]),e[0]||(e[0]=s("label",{for:"username"},"Nome",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"PHONE",value:l(a.data.phone),disabled:""},null,8,["value"]),e[1]||(e[1]=s("label",{for:"PHONE"},"Telemóvel",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"PAIS",value:l(a.data.country),disabled:""},null,8,["value"]),e[2]||(e[2]=s("label",{for:"PAIS"},"País",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"ZIP",value:l(a.data.zip_code),disabled:""},null,8,["value"]),e[3]||(e[3]=s("label",{for:"ZIP"},"Código Postal",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"CITY",value:l(a.data.city),disabled:""},null,8,["value"]),e[4]||(e[4]=s("label",{for:"CITY"},"Cidade",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"CUSTOMER_ID",value:l(a.data.customer_id),disabled:""},null,8,["value"]),e[5]||(e[5]=s("label",{for:"CUSTOMER_ID"},"ID do Cliente",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"STREET_1",value:l(a.data.street_1),disabled:""},null,8,["value"]),e[6]||(e[6]=s("label",{for:"STREET_1"},"Endereço",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"STREET_2",value:l(a.data.street_2),disabled:""},null,8,["value"]),e[7]||(e[7]=s("label",{for:"STREET_2"},"Complemento",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",value:l(a.data.order_id),disabled:""},null,8,["value"]),e[8]||(e[8]=s("label",{for:"order_id"},"Número do Pedido",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"PRODUCT_TITLE",value:l(a.data.product_title),disabled:""},null,8,["value"]),e[9]||(e[9]=s("label",{for:"PRODUCT_TITLE"},"Produto",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"SKU",value:l(a.data.sku),disabled:""},null,8,["value"]),e[10]||(e[10]=s("label",{for:"SKU"},"SKU",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"PRICE",value:l(a.data.price),disabled:""},null,8,["value"]),e[11]||(e[11]=s("label",{for:"PRICE"},"Preço",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"QUANTITY",value:l(a.data.quantity),disabled:""},null,8,["value"]),e[12]||(e[12]=s("label",{for:"QUANTITY"},"Quantidade",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"STATE_PROGRESS",value:l(a.data.state_progress),disabled:""},null,8,["value"]),e[13]||(e[13]=s("label",{for:"STATE_PROGRESS"},"Progresso do Pedido",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"ORDER_STATE",value:l(a.data.state),disabled:""},null,8,["value"]),e[14]||(e[14]=s("label",{for:"ORDER_STATE"},"Estado do Pedido",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"LEADTIME_TO_SHIP",value:l(a.data.leadtime_to_ship),disabled:""},null,8,["value"]),e[15]||(e[15]=s("label",{for:"LEADTIME_TO_SHIP"},"Tempo de Envio",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"LINK",value:l(a.data.link),disabled:""},null,8,["value"]),e[16]||(e[16]=s("label",{for:"LINK"},"Link do Produto",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"CURRENCY_ISO_CODE",value:l(a.data.currency_iso_code),disabled:""},null,8,["value"]),e[17]||(e[17]=s("label",{for:"CURRENCY_ISO_CODE"},"Código ISO da Moeda",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"SHIPPING_DEADLINE",value:l(a.data.shipping_deadline),disabled:""},null,8,["value"]),e[18]||(e[18]=s("label",{for:"SHIPPING_DEADLINE"},"Prazo de Envio",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"CUSTOMER_DEBITED_DATE",value:l(a.data.customer_debited_date),disabled:""},null,8,["value"]),e[19]||(e[19]=s("label",{for:"CUSTOMER_DEBITED_DATE"},"Data de Débito",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"LAST_UPDATED_DATE",value:l(a.data.last_updated_date),disabled:""},null,8,["value"]),e[20]||(e[20]=s("label",{for:"LAST_UPDATED_DATE"},"Última Atualização",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"HAS_CUSTOMER_MESSAGE",value:l(a.data.has_customer_message?"Sim":"Não"),disabled:""},null,8,["value"]),e[21]||(e[21]=s("label",{for:"HAS_CUSTOMER_MESSAGE"},"Mensagem do Cliente",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"HAS_INCIDENT",value:l(a.data.has_incident?"Sim":"Não"),disabled:""},null,8,["value"]),e[22]||(e[22]=s("label",{for:"HAS_INCIDENT"},"Incidente",-1))]),_:1}),t(i,{class:"flex justify-between"},{default:d(()=>[t(n,{class:"input_infos",id:"HAS_INVOICE",value:l(a.data.has_invoice?"Sim":"Não"),disabled:""},null,8,["value"]),e[23]||(e[23]=s("label",{for:"HAS_INVOICE"},"Fatura",-1))]),_:1})])]),_:1})])])}}},ne=C(ee,[["__scopeId","data-v-3dde24b8"]]);function ie(a,c){var o;return((o={1:{1:"Pedido Novo",2:"Em preparo",3:"Encomenda Feita",4:"Aguardando Tracking",5:"Concluido",6:"Sem Estoque",7:"Reembolsado",8:"Cancelado",9:"Tracking Fake",10:"Encomenda Fake"},2:{1:"status-tag status-1",2:"status-tag status-2",3:"status-tag status-3",4:"status-tag status-3",5:"status-tag status-4",6:"status-tag status-5",7:"status-tag status-5",8:"status-tag status-5",9:"status-tag status-6",10:"status-tag status-7"}}[c])==null?void 0:o[a])||null}function oe(a){switch(a){case"Enviado":return"pi pi-check-circle text-green-500";case"Recebido":return"pi pi-check text-green-500";case"Aguardando Envio":return"pi pi-clock text-surface-400";case"Reembolsado":return"pi pi-wallet text-red-500";case"Verificação de fraude":return"pi pi-info-circle text-orange-500";case"Cancelado":return"pi pi-wallet text-red-500";case"Aguardando Aceitação":return"pi pi-question text-surface-500"}}function de(a,c){const l=`${a}`,o={data:c,timestamp:Date.now()};sessionStorage.setItem(l,JSON.stringify(o))}function re(a,c){const l=sessionStorage.getItem(`${a}`);if(!l)return null;const{data:o,timestamp:e}=JSON.parse(l);return Date.now()-e>c?null:o}async function ue(a,c,l,o){const e=await fetch(`${c}/orders?page=${a}&limit=${l}&marketplace=${o}`,{method:"GET",credentials:"include"});if(e.redirected||e.status===302||e.status===401){window.location.href="/login";return}if(!e.ok)throw new Error("Erro ao buscar produtos");return await e.json()}async function ce(a,c,l,o,e){try{const n=await fetch(`${a}/orders/${o}/update`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({link:e,state_progress:l,sku:c}),credentials:"include"});if(!n.ok)throw new Error("Erro ${response.status}: Não foi possível atualizar o link.");return await n.json()}catch(n){console.error("Erro ao atualizar o link:",n)}}export{le as C,ne as R,ae as _,oe as a,ie as b,ue as f,re as g,de as s,ce as u};
